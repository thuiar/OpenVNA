{"ast":null,"code":"import { onMounted, watchEffect, onBeforeUnmount } from 'vue';\nimport '../../utils/index.mjs';\nimport { addUnit } from '../../utils/dom/style.mjs';\nconst useDraggable = (targetRef, dragRef, draggable) => {\n  let transform = {\n    offsetX: 0,\n    offsetY: 0\n  };\n  const onMousedown = e => {\n    const downX = e.clientX;\n    const downY = e.clientY;\n    const {\n      offsetX,\n      offsetY\n    } = transform;\n    const targetRect = targetRef.value.getBoundingClientRect();\n    const targetLeft = targetRect.left;\n    const targetTop = targetRect.top;\n    const targetWidth = targetRect.width;\n    const targetHeight = targetRect.height;\n    const clientWidth = document.documentElement.clientWidth;\n    const clientHeight = document.documentElement.clientHeight;\n    const minLeft = -targetLeft + offsetX;\n    const minTop = -targetTop + offsetY;\n    const maxLeft = clientWidth - targetLeft - targetWidth + offsetX;\n    const maxTop = clientHeight - targetTop - targetHeight + offsetY;\n    const onMousemove = e2 => {\n      const moveX = Math.min(Math.max(offsetX + e2.clientX - downX, minLeft), maxLeft);\n      const moveY = Math.min(Math.max(offsetY + e2.clientY - downY, minTop), maxTop);\n      transform = {\n        offsetX: moveX,\n        offsetY: moveY\n      };\n      targetRef.value.style.transform = `translate(${addUnit(moveX)}, ${addUnit(moveY)})`;\n    };\n    const onMouseup = () => {\n      document.removeEventListener(\"mousemove\", onMousemove);\n      document.removeEventListener(\"mouseup\", onMouseup);\n    };\n    document.addEventListener(\"mousemove\", onMousemove);\n    document.addEventListener(\"mouseup\", onMouseup);\n  };\n  const onDraggable = () => {\n    if (dragRef.value && targetRef.value) {\n      dragRef.value.addEventListener(\"mousedown\", onMousedown);\n    }\n  };\n  const offDraggable = () => {\n    if (dragRef.value && targetRef.value) {\n      dragRef.value.removeEventListener(\"mousedown\", onMousedown);\n    }\n  };\n  onMounted(() => {\n    watchEffect(() => {\n      if (draggable.value) {\n        onDraggable();\n      } else {\n        offDraggable();\n      }\n    });\n  });\n  onBeforeUnmount(() => {\n    offDraggable();\n  });\n};\nexport { useDraggable };","map":{"version":3,"mappings":"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","names":["useDraggable","targetRef","dragRef","draggable","transform","offsetX","offsetY","onMousedown","e","downX","clientX","downY","clientY","targetRect","value","getBoundingClientRect","targetLeft","left","targetTop","top","targetWidth","width","targetHeight","height","clientWidth","document","documentElement","clientHeight","minLeft","minTop","maxLeft","maxTop","onMousemove","e2","moveX","Math","min","max","moveY","style","addUnit","onMouseup","removeEventListener","addEventListener","onDraggable","offDraggable","onMounted","watchEffect","onBeforeUnmount"],"sources":["../../../../../packages/hooks/use-draggable/index.ts"],"sourcesContent":["import { onBeforeUnmount, onMounted, watchEffect } from 'vue'\nimport { addUnit } from '@element-plus/utils'\nimport type { ComputedRef, Ref } from 'vue'\n\nexport const useDraggable = (\n  targetRef: Ref<HTMLElement | undefined>,\n  dragRef: Ref<HTMLElement | undefined>,\n  draggable: ComputedRef<boolean>\n) => {\n  let transform = {\n    offsetX: 0,\n    offsetY: 0,\n  }\n\n  const onMousedown = (e: MouseEvent) => {\n    const downX = e.clientX\n    const downY = e.clientY\n    const { offsetX, offsetY } = transform\n\n    const targetRect = targetRef.value!.getBoundingClientRect()\n    const targetLeft = targetRect.left\n    const targetTop = targetRect.top\n    const targetWidth = targetRect.width\n    const targetHeight = targetRect.height\n\n    const clientWidth = document.documentElement.clientWidth\n    const clientHeight = document.documentElement.clientHeight\n\n    const minLeft = -targetLeft + offsetX\n    const minTop = -targetTop + offsetY\n    const maxLeft = clientWidth - targetLeft - targetWidth + offsetX\n    const maxTop = clientHeight - targetTop - targetHeight + offsetY\n\n    const onMousemove = (e: MouseEvent) => {\n      const moveX = Math.min(\n        Math.max(offsetX + e.clientX - downX, minLeft),\n        maxLeft\n      )\n      const moveY = Math.min(\n        Math.max(offsetY + e.clientY - downY, minTop),\n        maxTop\n      )\n\n      transform = {\n        offsetX: moveX,\n        offsetY: moveY,\n      }\n      targetRef.value!.style.transform = `translate(${addUnit(\n        moveX\n      )}, ${addUnit(moveY)})`\n    }\n\n    const onMouseup = () => {\n      document.removeEventListener('mousemove', onMousemove)\n      document.removeEventListener('mouseup', onMouseup)\n    }\n\n    document.addEventListener('mousemove', onMousemove)\n    document.addEventListener('mouseup', onMouseup)\n  }\n\n  const onDraggable = () => {\n    if (dragRef.value && targetRef.value) {\n      dragRef.value.addEventListener('mousedown', onMousedown)\n    }\n  }\n\n  const offDraggable = () => {\n    if (dragRef.value && targetRef.value) {\n      dragRef.value.removeEventListener('mousedown', onMousedown)\n    }\n  }\n\n  onMounted(() => {\n    watchEffect(() => {\n      if (draggable.value) {\n        onDraggable()\n      } else {\n        offDraggable()\n      }\n    })\n  })\n\n  onBeforeUnmount(() => {\n    offDraggable()\n  })\n}\n"]},"metadata":{},"sourceType":"module","externalDependencies":[]}